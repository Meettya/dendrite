(function(){"use strict";var e,r,t,n={};e={},r={"265WRV":function(e,r,t){function n(e,r){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))}function i(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},o="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":"undefined"==typeof e?"undefined":s(e)},u=function(){function e(e,r){var t=[],n=!0,i=!1,s=void 0;try{for(var o,u=e[Symbol.iterator]();!(n=(o=u.next()).done)&&(t.push(o.value),!r||t.length!==r);n=!0);}catch(a){i=!0,s=a}finally{try{!n&&u["return"]&&u["return"]()}finally{if(i)throw s}}return t}return function(r,t){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return e(r,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),l=n(["Undefined publisher engine type |","|"],["Undefined publisher engine type |","|"]);Object.defineProperty(e,"__esModule",{value:!0});var c=3,h=2,b=1,f=0,y=Symbol("internal subscribe bus"),p=Symbol("internal unsubscribe bus"),v=function(){function e(r){i(this,e),this.observerVerboseLevel=this.parseVerboseLevel(r),this.publishingCounter=0,this.subscriptions=new Map,this.tasksCounter=0,this.tasksDictionary=new WeakMap,this.unsubscribeQueue=[]}return a(e,[{key:"subscribe",value:function(e,r,t){return this.subscribeGuarded(e,r,void 0,t)}},{key:"subscribeGuarded",value:function(e,r,t,n){if("string"!=typeof e&&!this.isInternalChannel(e)||"function"!=typeof r||t&&"function"!=typeof t)throw this.subscribeErrorMessage(e,r,t,n);var i={},s=this.topicsToArraySplitter(e);this.tasksDictionary.set(i,[r,n,t]);var o=!0,u=!1,a=void 0;try{for(var l,c=s[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var h=l.value,b=[];this.subscriptions.has(h)&&(b=this.subscriptions.get(h)),b.push(i),this.subscriptions.set(h,b),this.isInternalChannel(h)||this.publishAsync(y,h)}}catch(f){u=!0,a=f}finally{try{!o&&c["return"]&&c["return"]()}finally{if(u)throw a}}return{topics:e,callback:r,watchdog:t,context:n}}},{key:"unsubscribe",value:function(e,r,t){var n=void 0;if(e.topics){var i=this.handlerParser(e,r,t),s=u(i,3);e=s[0],r=s[1],t=s[2]}if("string"!=typeof e&&!this.isInternalChannel(e))throw this.unsubscribeErrorMessage(e,r,t);if(this.isPublishing())return this.unsubscribeQueue.push([e,r,t]),this;n=this.topicsToArraySplitter(e);var o=!0,a=!1,l=void 0;try{for(var c,h=n[Symbol.iterator]();!(o=(c=h.next()).done);o=!0){var b=c.value;if(this.subscriptions.has(b)){if("function"==typeof r){var f=this.subscriptions.get(b),y=!0,v=!1,d=void 0;try{for(var g,m=f.entries()[Symbol.iterator]();!(y=(g=m.next()).done);y=!0){var k=u(g.value,2),w=k[0],E=k[1],S=this.tasksDictionary.get(E);if(S){var C=u(S,2),T=C[0],L=C[1];Object.is(T,r)&&(t?Object.is(L,t)&&f.splice(w,1):f.splice(w,1))}}}catch(x){v=!0,d=x}finally{try{!y&&m["return"]&&m["return"]()}finally{if(v)throw d}}this.subscriptions.set(b,f)}else this.subscriptions["delete"](b);this.isInternalChannel(b)||this.publishAsync(p,b)}}}catch(x){a=!0,l=x}finally{try{!o&&h["return"]&&h["return"]()}finally{if(a)throw l}}return this}},{key:"publish",value:function(e){for(var r=arguments.length,t=Array(r>1?r-1:0),n=1;r>n;n++)t[n-1]=arguments[n];return this.publisher("sync",e,t),this}},{key:"publishSync",value:function(e){for(var r=arguments.length,t=Array(r>1?r-1:0),n=1;r>n;n++)t[n-1]=arguments[n];return this.publisher("sync",e,t),this}},{key:"publishAsync",value:function(e){for(var r=arguments.length,t=Array(r>1?r-1:0),n=1;r>n;n++)t[n-1]=arguments[n];return this.publisher("async",e,t),this}},{key:"getListenedTopicsList",value:function(){var e=[],r=!0,t=!1,n=void 0;try{for(var i,s=this.subscriptions.entries()[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var o=u(i.value,2),a=o[0],l=o[1];l.length&&!this.isInternalChannel(a)&&e.push(a)}}catch(c){t=!0,n=c}finally{try{!r&&s["return"]&&s["return"]()}finally{if(t)throw n}}return e}},{key:"isTopicListened",value:function(e){if("string"!=typeof e||""===e)throw this.isTopicListenedErrorMessage(e,"isTopicListened","topic");return!!this.getSubscribtionsCount(e)}},{key:"on",value:function(e,r){var t=void 0;if("string"!=typeof e||""===e)throw this.isTopicListenedErrorMessage(e,"on","activity type");if("function"!=typeof r)throw TypeError("callback is not function");if(t=e.toLowerCase(),"subscribe"===t)return this.subscribe(y,function(e,t){r(t)});if("unsubscribe"===t)return this.subscribe(p,function(e,t){r(t)});throw Error("unknown activity type |"+e+"|")}},{key:"off",value:function(e){if(e&&"object"===("undefined"==typeof e?"undefined":o(e))&&e.topics){var r=void 0,t=void 0,n=this.handlerParser(e),i=u(n,3);e=i[0],r=i[1],t=i[2],this.unsubscribe(e,r,t)}else{var s=void 0,a=void 0;if("string"!=typeof e||""===e)throw this.isTopicListenedErrorMessage(e,"off","activity type");if(s=e.toLowerCase(),"subscribe"===s)a=y;else{if("unsubscribe"!==s)throw Error("unknown activity type |"+e+"|");a=p}this.unsubscribe(a)}}},{key:"isInternalChannel",value:function(e){return e===y||e===p}},{key:"handlerParser",value:function(e,r,t){var n=e.topics;return r||(r=e.callback),t||(t=e.context),[n,r,t]}},{key:"isPublishing",value:function(){return!!this.publishingCounter}},{key:"getPublisherEngine",value:function(e){var r=void 0,t=void 0,n=this;if(r={sync:{publish:n.publishFiring,unsubscribe:n.unsubscribeResume},async:{publish:function(e,r,t){setImmediate(function(){n.publishFiring(e,r,t)})},unsubscribe:function(){setImmediate(function(){n.unsubscribeResume()})}}},t=r[e],!t)throw TypeError(l,e);return[t.publish,t.unsubscribe]}},{key:"publisher",value:function(e,r,t){var n=void 0,i=this.getPublisherEngine(e),s=u(i,2),o=s[0],a=s[1];if("string"!=typeof r&&!this.isInternalChannel(r))throw this.publishErrorMessage(r,t);n=this.topicsToArraySplitter(r,!1);var l=!0,c=!1,h=void 0;try{for(var b,f=n[Symbol.iterator]();!(l=(b=f.next()).done);l=!0){var y=b.value;if(this.subscriptions.has(y)){var p=!0,v=!1,d=void 0;try{for(var g,m=this.subscriptions.get(y)[Symbol.iterator]();!(p=(g=m.next()).done);p=!0){var k=g.value,w=this.tasksDictionary.get(k);w&&(this.publishingInc(),o.call(this,y,w,t))}}catch(E){v=!0,d=E}finally{try{!p&&m["return"]&&m["return"]()}finally{if(v)throw d}}}}}catch(E){c=!0,h=E}finally{try{!l&&f["return"]&&f["return"]()}finally{if(c)throw h}}a.call(this)}},{key:"publishingInc",value:function(){this.publishingCounter=this.publishingCounter+1}},{key:"publishingDec",value:function(){if(!this.publishingCounter)throw Error("Error on decrement publishing counter - this.publishingCounte is |#{this.publishingCounte}|");this.publishingCounter=this.publishingCounter-1}},{key:"topicsToArraySplitter",value:function(e){var r=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],t=void 0,n=[],i={};if(this.isInternalChannel(e))return[e];t=e.split(" ");var s=!0,o=!1,u=void 0;try{for(var a,l=t[Symbol.iterator]();!(s=(a=l.next()).done);s=!0){var c=a.value;""===c||r&&i[c]||(i[c]=!0,n.push(c))}}catch(h){o=!0,u=h}finally{try{!s&&l["return"]&&l["return"]()}finally{if(o)throw u}}return n}},{key:"getVerboseLevel",value:function(){return this.observerVerboseLevel}},{key:"getSubscribtionsCount",value:function(e){var r=this.subscriptions.get(e);return r?r.length:void 0}},{key:"unsubscribeResume",value:function(){var e=void 0;if(this.unsubscribeQueue.length){if(this.isPublishing())return void(this.observerVerboseLevel>=c&&console.log("still publishing"));do e=this.unsubscribeQueue.shift(),e&&(this.observerVerboseLevel>=c&&console.log("retry unsubscribe |"+e+"|"),this.unsubscribe.apply(this,e));while(e)}}},{key:"publishFiring",value:function(e,r,t){try{r[0].apply(r[1]||{},[e].concat(t))}catch(n){r[2]&&r[2].call(r[1]||{},n,{topic:e,callback:r[0],object:r[1],data:t}),this.observerVerboseLevel>=b&&console.error("Error: on call subscribe callback we got exception\n          topic     = |"+e+"|\n          callback  = |"+r[0]+"|\n          watchdog  = |"+r[2]+"|\n          object    = |"+(JSON.stringify(r[1])||r[1])+"|\n          data      = |"+t+"|\n          error     = |"+n+"|\n        "),this.observerVerboseLevel===c&&n.stack&&console.error(n.stack)}finally{this.publishingDec()}}},{key:"parseVerboseLevel",value:function(e){if(e&&"object"===("undefined"==typeof e?"undefined":o(e))){var r=e.verbose;if(r){if("string"!=typeof r)throw TypeError("Error on parsing verbose level - not a String |"+r+"|");switch(r.toUpperCase()){case"DEBUG":return c;case"SILENT":return f;case"ERROR":return b;case"WARNING":return h;default:throw Error("Unknown verbose level |"+r+"|")}}}return b}},{key:"subscribeErrorMessage",value:function(e,r,t,n){var i="Error! on call |subscribe| used non-string topics OR/AND callback isn`t function OR/AND watchdog defined but isn`t function:\n      topics    = |"+e+"|\n      callback  = |"+r+"|\n      watchdog  = |"+t+"|\n      context   = |"+n+"|";return TypeError(i)}},{key:"publishErrorMessage",value:function(e,r){var t="Error on call |publish| used non-string topics:\n      topics    = |"+e+"|\n      data      = |"+r+"|";return TypeError(t)}},{key:"unsubscribeErrorMessage",value:function(e,r,t){var n="Error on call |unsubscribe| used non-string topics:\n      topics    = |"+e+"|\n      callback  = |"+r+"|\n      context   = |"+t+"|";return TypeError(n)}},{key:"isTopicListenedErrorMessage",value:function(e,r,t){var n="Error on call |"+r+"| used non-string, or empty string as "+t+":\n      "+t+"  = |"+e+"|";return TypeError(n)}}]),e}();e["default"]=v,r.exports=v}};var i=function(e){var r,t;return r=function(e){return function(r,t){if(null==e[r])throw Error("no dependencies list for parent |"+r+"|");if(null==e[r][t])throw Error("no one module resolved, name - |"+t+"|, parent - |"+r+"|");return e[r][t]}},t=function(e,r,t){var n,i,s=this;return n=function(n,s){var o,u;if(!((o=e[n])||(u=r(s,n),o=e[u])))throw Error("can`t find module source code: original_name - |"+n+"|, resolved_name - |"+u+"|");return u=null!=u?u:n,null!=t?null!=t[u]?t[u]:t[u]=i(o,u):i(o,u)},i=function(e,r){var t,i,o;return e.call(s,t={},i={exports:t},function(e){return n(e,r)}),null!=(o=i.exports)?o:t},n},e.require_builder=function(e,n,i){return t.call(this,n,r(e),i)},e}({});t=i.require_builder.call(this,e,r,n),this.Dendrite=t("265WRV")}).call(this);